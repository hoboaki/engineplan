# VulkanSample フォルダについて

Vulkan グラフィックス API を使った AdelEngine GfxLowApi 試作用のフォルダです。

## AdelEngine GfxLowApi について

AdelEngine GfxLowApi は
Vulkan、DirectX 12、Metal およびその他の低レベルグラフィックス API をターゲットとしている
マルチプラットフォームな低レベルグラフィックス API のライブラリです。

AdelEngine GfxLowApi は互換性に配慮し、
原則として１つのコードで複数の低レベルグラフィックス API 環境で動作することも目的としています。
つまり、Vulkan 環境でも DirectX 12 環境でも Metal 環境でも、その他の低レベルグラフィックス API 環境でも動作する、ということです。
現時点では Vulkan 環境でしか動作しませんが、API を作る際には各低レベルグラフィックス API の仕様を把握した上で設計することで
ユーザーに提供する API は変更せずに将来的に対応する低レベルグラフィックス API 環境を増やせる見込みです。
※実運用するとうまくいかないケースはもちろんあると思うので、現時点では完璧ではありません。

AdelEngine GfxLowApi は
いずれの低レベルグラフィックス API 環境でも CPU やメモリの効率面で
そこそこのパフォーマンスが出せるようにすることを目的に設計されています。
各低レベルグラフィックス API の仕様を調査することで
互換性だけでなく、パフォーマンス面も配慮した API を提供します。

AdelEngine GfxLowApi は高機能な API は提供しません。
例えば GPU ローカルなデバイスメモリにテクスチャをアップロードする便利機能や
FBX 形式のデータを読み込み表示する機能などは提供しません。
それは別レイヤーの機能として提供されることを想定しています。

AdelEngine GfxLowApi のオーバービューは [ApiOverview.md] に記載されています。概要を知りたい方はそちらをご覧下さい。

## 開発環境

- Visual Studio 2019 : 16.11.2
- Vulkan SDK : 1.2.182.0
- clang-format : 12.0.1

## 座標系

本サンプルの座標系は右手座標系（表面：反時計周り、Up：+Y）・左上 UV 原点としており、各種ジオメトリデータもこの仕様に準じています。
たびたびシェーダーコードに Y の符号を反転させているところがありますが、
これはフレームバッファ（Up：-Y）の空間に描画した際に Up 軸を揃えるようにするための処理です。

## AeVulkan01 - Simple

AdelEngine GfxLowApi を使ってテクスチャを貼り付けたキューブを表示するデモです。
ラッパークラスは使わずにあえて GfxLowApi を直接使っているためコード量が多めです。

## AeVulkan02 - Screen Resize

AeVulkan01 のサンプルにスクリーンリサイズのための処理を追加したデモです。
スクリーンリサイズはウィンドウのサイズが変更されたときに発生します。
スクリーンをリサイズする際は Swapchain を再生成する必要があり、そのコードが追加されています。

## AeVulkan03 - Screen Resize With Aesk

AeVulkan02 のサンプルを aesk モジュールを使って書き直したデモです。
aesk モジュールは定型処理をまとめた便利クラスや処理を提供するモジュールで、
本サンプルはそのモジュールを使うことにより AeVulkan02 と比べてコード量が少なくなっています。

## AeVulkan04 - Compute Shader

コンピュートシェーダーの動作デモです。
StorageBuffer を使ってコンピュートシェーダーで計算した結果を CPU 上で受け取りコンソール出力します。

## AeVulkan05 - Storage Image

StorageImage を使ってコンピュートシェーダーからテクスチャイメージを生成し表示するデモです。
コンピュートシェーダーでは同心円状のテクスチャイメージを生成します。

## AeVulkan06 - Cube Map

キューブマップイメージを生成し表示するデモです。
６枚の画像をキューブマップイメージの各面に転送して生成しています。

<参考> キューブマップの解説ページ
https://scalibq.wordpress.com/2013/06/23/cubemaps/

## AeVulkan07 - Multi Render Target

マルチレンダーターゲットのデモです。
１パス目で２枚のレンダーターゲットに描画し、２パス目で１パス目の描画結果を合成して描画しています。

## AeVulkan08 - Secondary Command Buffer

プライマリコマンドバッファから保存済のセカンダリコマンドバッファを呼び出すデモです。
保存済のセカンダリコマンドバッファを再利用することでコマンド生成処理の最適化を行います。

## AeVulkan09 - Copy Buffer

AeVulkan08 のサンプルに Copy Buffer を使って最適化をしたデモです。
AeVulkan08 のデモではセカンダリコマンドバッファを Swapchain の数分用意していました。
これは毎フレームユニフォームバッファを更新する必要があったからです。
このデモでは参照するユニフォームバッファを１つだけにし、
Copy Buffer コマンドを使ってユニフォームバッファの値を更新するようにしています。
そうすることでセカンダリコマンドバッファの数を１つだけにすることができ、
コマンドバッファの更新処理の削減やメモリの節約につながります。

## AeVulkan10 - Indirect Draw

インダイレクト描画のデモです。
インダイレクト描画コマンドを使ってキューブと球それぞれの描画の ON/OFF を切り替えています。
キューブがインデックスバッファを使わないタイプ、球がインデックスバッファを使うタイプの描画コールになります。
